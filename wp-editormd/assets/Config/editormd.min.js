!function(l,c,e,p){var t,i;function r(e,t){var i;switch(t){case"emojify":i=e+"/assets/Emojify.js/images/basic";break;case"katex":i=e+"/assets/KaTeX";break;case"mermaid":i=e+"/assets/Mermaid";break;case"prismjs":i=e+"/assets/Prism.js";break;case"codemirror":i=e+"/assets/CodeMirror";break;case"marked":i=e+"/assets/Marked"}return i}l(c).ready(function(){var i=null;if(c.getElementById("wp-content-editor-container"))i="wp-content-editor-container";else if(c.getElementById("wp-replycontent-editor-container")&&"on"===p.supportReply)i="wp-replycontent-editor-container";else if(c.getElementById("comment")&&"on"===p.supportComment)i="comment",l("#comment").after("<div id='comment'></div>").remove();else{if(""===p.supportOther)return!1;i=p.supportOther,l("#"+p.supportOther).after("<div id="+p.supportOther+"></div>").remove()}var e,t=["undo","redo","|","bold","del","italic","quote","ucwords","uppercase","lowercase","|","h1","h2","h3","h4","h5","h6","|","list-ul","list-ol","hr","|","link","reference-link","image","code","code-block","table","datetime","off"!==p.emoji?"emoji":"html-entities","more","pagebreak","|","goto-line","watch","preview","fullscreen","clear","search","|","help","info"],r=["bold","del","italic","quote","ucwords","uppercase","lowercase","|","link","reference-link","image","code","code-block","table","datetime","off"!==p.emoji?"emoji":"html-entities","|","watch","preview","fullscreen","clear","info"],o=["ucwords","uppercase","lowercase","|","link","reference-link","image","table","datetime","off"!==p.emoji?"emoji":"html-entities","|","watch","preview","fullscreen","info"];switch(i){case"wp-content-editor-container":e=t;break;case"comment":e=r;break;case"wp-replycontent-editor-container":e=o;break;default:e=t}var m=editormd({id:i,path:p.editormdUrl+"/assets/Editormd/lib/",width:"100%",height:"wp-content-editor-container"===i?640:320,syncScrolling:"off"!==p.syncScrolling,watch:"wp-replycontent-editor-container"!==i&&"off"!==p.livePreview,htmlDecode:"off"!==p.htmlDecode,toolbarAutoFixed:!1,toolbar:!0,autoFocus:"comment"!==i,tocm:!1,tocContainer:"off"!==p.toc&&"",tocDropdown:!1,theme:p.theme,previewTheme:p.previewTheme,editorTheme:p.editorTheme,emoji:"off"!==p.emoji,tex:"off"!==p.tex,mind:"off"!==p.mindMap,mermaid:"off"!==p.mermaid,atLink:!1,taskList:"off"!==p.taskList,imageUpload:"off"!==p.imagePasteSM,imageFormats:["jpg","jpeg","gif","png","bmp","webp"],imageUploadURL:"https://sm.ms/api/upload",placeholder:p.placeholderEditor,prismTheme:p.prismTheme,prismLineNumbers:"off"!==p.prismLineNumbers,toolbarIcons:function(){return e},onfullscreen:function(){c.getElementById(i).style.position="fixed",c.getElementById(i).style.zIndex="99999"},onfullscreenExit:function(){c.getElementById(i).style.position="relative",c.getElementById(i).style.zIndex="auto"},onload:function(){if("comment"===i&&l("textarea.editormd-markdown-textarea").attr("name","comment"),"wp-replycontent-editor-container"===i&&l(".reply").click(function(){setTimeout(function(){l(".edit-comments-php .CodeMirror.cm-s-default.CodeMirror-wrap").css("margin-top",l(".editormd-toolbar").height())},100)}),1600===function(){if(this.innerWidth)return this.innerWidth;if(document.documentElement&&document.documentElement.clientWidth)return document.documentElement.clientWidth;if(document.body)return document.body.clientWidth}()){var e=l(".editormd .CodeMirror.CodeMirror-wrap"),t=e.css("margin-top");e.css("margin-top",parseInt(t)-32+"px")}}});if("undefined"!=typeof wp&&void 0!==wp.media){var a=wp.media.editor.insert,n=new TurndownService;wp.media.editor.insert=function(e){var t=n.turndown(e);a(t),m.insertValue(t)}}"on"===p.imagePaste&&l("#"+i).on("paste",function(e){e=e.originalEvent;var t=window.clipboardData||e.clipboardData,i=window.navigator.userAgent;if(e.clipboardData&&e.clipboardData.items){var n={line:m.getCursor().line,ch:m.getCursor().ch};if(!(t.items&&2===t.items.length&&"string"===t.items[0].kind&&"file"===t.items[1].kind&&t.types&&2===t.types.length&&"text/plain"===t.types[0]&&"Files"===t.types[1]&&i.match(/Macintosh/i)&&Number(i.match(/Chrome\/(\d{2})/i)[1])<49)){var r,o,a,d=t.items.length;if(0!==d)if(1!==d||"string"!==t.items[0].kind)if(1===d&&"file"===t.items[0].kind){var s=t.items[0].getAsFile();if(0===s.size)return;r=s,o=function(e){var i="!["+p.imgUploading+"]",r="!["+p.imgUploadeFailed+"]",t={action:"imagepaste_action",dataurl:e};if(m.insertValue(i),"on"===p.imagePasteSM){var o=new FormData,a="http:"!==c.location.protocol;o.append("smfile",function(e){var t;t=0<=e.split(",")[0].indexOf("base64")?atob(e.split(",")[1]):decodeURI(e.split(",")[1]);for(var i=e.split(",")[0].split(":")[1].split(";")[0],r=new Uint8Array(t.length),o=0;o<t.length;o++)r[o]=t.charCodeAt(o);return new Blob([r],{type:i})}(e)),o.append("ssl",a),o.append("format","json"),l.ajax({url:"https://sm.ms/api/upload",type:"POST",processData:!1,contentType:!1,data:o,success:function(e){"success"===e.code?"on"===p.imageLink?m.setValue(m.getValue().replace(i,"[!["+e.data.filename+"]("+e.data.url+")]("+e.data.url+")")):m.setValue(m.getValue().replace(i,"!["+e.data.filename+"]("+e.data.url+")")):m.setValue(m.getValue().replace(i,r+"[ "+e.msg+" ]")),m.setCursor(n),m.focus()}})}else l.ajax({url:ajaxurl,type:"POST",data:t,success:function(e){var t=JSON.parse(e);t.error?m.setValue(m.getValue().replace(i,r)):"on"===p.imageLink?m.setValue(m.getValue().replace(i,"[![]("+t.url+")]("+t.url+")")):m.setValue(m.getValue().replace(i,"![]("+t.url+")")),m.setCursor(n),m.focus()}})},(a=new FileReader).onload=function(e){o(e.target.result)},a.readAsDataURL(r)}}}})}),editormd.codeMirrorURL={url:r(p.editormdUrl,"codemirror")},editormd.markedURL={js:r(p.editormdUrl,"marked")+"/marked.min"},editormd.prismURL={url:r(p.editormdUrl,"prismjs")},editormd.mindMapURL=(t=p.mindMapURL,null!==(i=/\.{1}[a-z]{1,}$/).exec(t)?t.slice(0,i.exec(t).index):t),"on"===p.tex&&(editormd.katexURL={css:r(p.editormdUrl,"katex")+"/katex.min",js:r(p.editormdUrl,"katex")+"/katex.min"}),"on"===p.mermaid&&(editormd.mermaidURL={js:r(p.editormdUrl,"mermaid")+"/mermaid.min"}),"on"===p.emoji&&(editormd.emoji={path:r(p.editormdUrl,"emojify")+"/",ext:".png"})}(window.jQuery,document,window,window.Editormd);